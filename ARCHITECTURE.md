# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ Crypto Coursework

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
crypto_coursework/
‚îú‚îÄ‚îÄ include/crypto/              # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ ciphers/                 # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —à–∏—Ñ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cipher.hpp          # ICipher (–±–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ block_cipher.hpp    # IBlockCipher
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stream_cipher.hpp   # IStreamCipher
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ asymmetric_cipher.hpp # IAsymmetricCipher
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ algorithms/              # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ des/                # DES, TripleDES
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deal/               # DEAL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rijndael/           # AES (Rijndael)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serpent/            # Serpent
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rc4/                # RC4
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rsa/                # RSA
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ diffie_hellman/      # Diffie-Hellman
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ modes/                  # –†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mode.hpp            # IBlockCipherMode
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ecb.hpp, cbc.hpp, etc.
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stream_cipher_mode.hpp  # –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ asymmetric_cipher_mode.hpp # –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ padding/                # –°—Ö–µ–º—ã –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ core/                   # –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ math/                   # –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ io/                     # –§–∞–π–ª–æ–≤—ã–π –≤–≤–æ–¥/–≤—ã–≤–æ–¥
‚îÇ   ‚îî‚îÄ‚îÄ crypto_manager.hpp      # –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API
‚îÇ
‚îî‚îÄ‚îÄ src/                        # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    ‚îú‚îÄ‚îÄ algorithms/             # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
    ‚îú‚îÄ‚îÄ modes/                  # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∂–∏–º–æ–≤
    ‚îú‚îÄ‚îÄ padding/                # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–¥–¥–∏–Ω–≥–æ–≤
    ‚îú‚îÄ‚îÄ core/                   # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Ç–∏–ª–∏—Ç
    ‚îú‚îÄ‚îÄ math/                   # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
    ‚îú‚îÄ‚îÄ io/                     # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤–æ–≥–æ I/O
    ‚îî‚îÄ‚îÄ crypto_manager.cpp      # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
```

## üèóÔ∏è –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤

### 1. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —à–∏—Ñ—Ä–æ–≤ (ciphers/)

```
ICipher (–±–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îú‚îÄ‚îÄ name()
‚îú‚îÄ‚îÄ blockSize()
‚îú‚îÄ‚îÄ keySize()
‚îú‚îÄ‚îÄ setKey()
‚îî‚îÄ‚îÄ isValidKey()
    ‚îÇ
    ‚îú‚îÄ‚îÄ IBlockCipher (–±–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã)
    ‚îÇ   ‚îú‚îÄ‚îÄ encryptBlock()
    ‚îÇ   ‚îú‚îÄ‚îÄ decryptBlock()
    ‚îÇ   ‚îú‚îÄ‚îÄ encryptBlocks()
    ‚îÇ   ‚îî‚îÄ‚îÄ decryptBlocks()
    ‚îÇ
    ‚îú‚îÄ‚îÄ IStreamCipher (–ø–æ—Ç–æ–∫–æ–≤—ã–µ —à–∏—Ñ—Ä—ã)
    ‚îÇ   ‚îú‚îÄ‚îÄ encrypt()
    ‚îÇ   ‚îú‚îÄ‚îÄ decrypt()
    ‚îÇ   ‚îî‚îÄ‚îÄ reset()
    ‚îÇ
    ‚îî‚îÄ‚îÄ IAsymmetricCipher (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ —à–∏—Ñ—Ä—ã)
        ‚îú‚îÄ‚îÄ encrypt()
        ‚îî‚îÄ‚îÄ decrypt()
```

### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (algorithms/)

```
IBlockCipher
‚îú‚îÄ‚îÄ DES
‚îú‚îÄ‚îÄ TripleDES
‚îú‚îÄ‚îÄ DEAL
‚îú‚îÄ‚îÄ Rijndael (AES)
‚îî‚îÄ‚îÄ Serpent

IStreamCipher
‚îî‚îÄ‚îÄ RC4

IAsymmetricCipher
‚îî‚îÄ‚îÄ RSA
```

### 3. –†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (modes/)

```
IBlockCipherMode (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îú‚îÄ‚îÄ ECBMode
‚îú‚îÄ‚îÄ CBCMode
‚îú‚îÄ‚îÄ PCBCMode
‚îú‚îÄ‚îÄ CFBMode
‚îú‚îÄ‚îÄ OFBMode
‚îú‚îÄ‚îÄ CTRMode
‚îú‚îÄ‚îÄ RandomDeltaMode
‚îú‚îÄ‚îÄ StreamCipherMode (–∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è IStreamCipher)
‚îî‚îÄ‚îÄ AsymmetricCipherMode (–∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è IAsymmetricCipher)
```

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏

### –ü—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å (—á–µ—Ä–µ–∑ CryptoManager):

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    ‚îÇ
    ‚îú‚îÄ> CryptoManager::encrypt()
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îú‚îÄ> parseMode()          # "CBC" ‚Üí CipherMode::CBC
    ‚îÇ       ‚îú‚îÄ> parsePadding()       # "PKCS7" ‚Üí PaddingType::PKCS7
    ‚îÇ       ‚îî‚îÄ> createEncryptor()
    ‚îÇ               ‚îÇ
    ‚îÇ               ‚îú‚îÄ> createCipher()      # "DES" ‚Üí DES instance
    ‚îÇ               ‚îÇ       ‚îÇ
    ‚îÇ               ‚îÇ       ‚îî‚îÄ> DES::setKey()
    ‚îÇ               ‚îÇ
    ‚îÇ               ‚îî‚îÄ> IBlockCipherMode::create()  # mode_factory.cpp
    ‚îÇ                       ‚îÇ
    ‚îÇ                       ‚îî‚îÄ> new CBCMode(cipher, padding)
    ‚îÇ
    ‚îî‚îÄ> IBlockCipherMode::encrypt()
            ‚îÇ
            ‚îú‚îÄ> IPadding::pad()              # –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
            ‚îú‚îÄ> CBCMode::encrypt()           # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞–º–∏
            ‚îÇ       ‚îÇ
            ‚îÇ       ‚îî‚îÄ> DES::encryptBlock()  # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞
            ‚îÇ
            ‚îî‚îÄ> –†–µ–∑—É–ª—å—Ç–∞—Ç: ByteArray
```

### –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –≤ CBC:

```
1. CBCMode::encrypt(plaintext)
   ‚îÇ
2. IPadding::pad(plaintext) ‚Üí padded_data
   ‚îÇ
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îÇ
   ‚îú‚îÄ> XOR(block, previous_ciphertext) ‚Üí xored_block
   ‚îÇ       (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–ª–æ–∫–∞: XOR(block, IV))
   ‚îÇ
   ‚îú‚îÄ> DES::encryptBlock(xored_block) ‚Üí cipher_block
   ‚îÇ
   ‚îî‚îÄ> cipher_block ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

## üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    CryptoManager                            ‚îÇ
‚îÇ  (–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API - crypto_manager.cpp)                 ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚Ä¢ createEncryptor()                                        ‚îÇ
‚îÇ  ‚Ä¢ encrypt() / decrypt()                                    ‚îÇ
‚îÇ  ‚Ä¢ generateKey()                                            ‚îÇ
‚îÇ  ‚Ä¢ parseMode() / parsePadding()                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ                                     ‚îÇ
                 ‚ñº                                     ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   Mode Factory       ‚îÇ          ‚îÇ   Cipher Factory         ‚îÇ
    ‚îÇ  (mode_factory.cpp)  ‚îÇ          ‚îÇ  (crypto_manager.cpp)    ‚îÇ
    ‚îÇ                      ‚îÇ          ‚îÇ                          ‚îÇ
    ‚îÇ  ‚Ä¢ create()          ‚îÇ          ‚îÇ  ‚Ä¢ createCipher()         ‚îÇ
    ‚îÇ    - CBCMode         ‚îÇ          ‚îÇ    - DES                  ‚îÇ
    ‚îÇ    - ECBMode         ‚îÇ          ‚îÇ    - TripleDES            ‚îÇ
    ‚îÇ    - CFBMode         ‚îÇ          ‚îÇ    - DEAL                  ‚îÇ
    ‚îÇ    - ...             ‚îÇ          ‚îÇ    - Rijndael             ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ                                  ‚îÇ
               ‚îÇ                                  ‚îÇ
               ‚ñº                                  ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  IBlockCipherMode     ‚îÇ          ‚îÇ   IBlockCipher           ‚îÇ
    ‚îÇ  (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)          ‚îÇ          ‚îÇ   (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)            ‚îÇ
    ‚îÇ                       ‚îÇ          ‚îÇ                          ‚îÇ
    ‚îÇ  ‚Ä¢ encrypt()          ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  ‚Ä¢ encryptBlock()        ‚îÇ
    ‚îÇ  ‚Ä¢ decrypt()          ‚îÇ          ‚îÇ  ‚Ä¢ decryptBlock()        ‚îÇ
    ‚îÇ  ‚Ä¢ setCipher()        ‚îÇ          ‚îÇ  ‚Ä¢ blockSize()           ‚îÇ
    ‚îÇ  ‚Ä¢ setPadding()       ‚îÇ          ‚îÇ  ‚Ä¢ keySize()             ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ                                  ‚îÇ
               ‚îÇ                                  ‚îÇ
               ‚ñº                                  ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  IPadding             ‚îÇ          ‚îÇ   –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:            ‚îÇ
    ‚îÇ  (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)          ‚îÇ          ‚îÇ   ‚Ä¢ DES                  ‚îÇ
    ‚îÇ                       ‚îÇ          ‚îÇ   ‚Ä¢ TripleDES            ‚îÇ
    ‚îÇ  ‚Ä¢ pad()              ‚îÇ          ‚îÇ   ‚Ä¢ DEAL                 ‚îÇ
    ‚îÇ  ‚Ä¢ unpad()            ‚îÇ          ‚îÇ   ‚Ä¢ Rijndael             ‚îÇ
    ‚îÇ                       ‚îÇ          ‚îÇ   ‚Ä¢ Serpent              ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. CryptoManager (crypto_manager.cpp)

**–†–æ–ª—å:** –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–µ–π

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `createEncryptor()` - —Å–æ–∑–¥–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —à–∏—Ñ—Ä
- `encrypt() / decrypt()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `generateKey()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
- `parseMode() / parsePadding()` - –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫ –≤ enum

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```cpp
CryptoManager manager;
Key key = manager.generateKey("DES");
auto encryptor = manager.createEncryptor("DES", "CBC", "PKCS7", key);
ByteArray encrypted = encryptor->encrypt(data);
```

### 2. Mode Factory (mode_factory.cpp)

**–†–æ–ª—å:** –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**–ú–µ—Ç–æ–¥:**
- `IBlockCipherMode::create()` - —Ñ–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤

**–°–æ–∑–¥–∞–µ—Ç:**
- `ECBMode`, `CBCMode`, `PCBCMode`, `CFBMode`, `OFBMode`, `CTRMode`, `RandomDeltaMode`
- `StreamCipherMode` (–∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö —à–∏—Ñ—Ä–æ–≤)
- `AsymmetricCipherMode` (–∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö —à–∏—Ñ—Ä–æ–≤)

### 3. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —à–∏—Ñ—Ä–æ–≤ (ciphers/)

#### ICipher (cipher.hpp)
–ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —à–∏—Ñ—Ä–æ–≤:
- `name()` - –∏–º—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- `blockSize()` - —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
- `keySize()` - —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞
- `setKey()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª—é—á–∞
- `isValidKey()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞

#### IBlockCipher (block_cipher.hpp)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±–ª–æ—á–Ω—ã—Ö —à–∏—Ñ—Ä–æ–≤:
- `encryptBlock()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞
- `decryptBlock()` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞
- `encryptBlocks()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤
- `decryptBlocks()` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `DES` - Data Encryption Standard
- `TripleDES` - Triple DES
- `DEAL` - Data Encryption Algorithm with Larger blocks
- `Rijndael` - AES (Advanced Encryption Standard)
- `Serpent` - Serpent cipher

#### IStreamCipher (stream_cipher.hpp)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö —à–∏—Ñ—Ä–æ–≤:
- `encrypt()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- `decrypt()` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- `reset()` - —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `RC4` - Rivest Cipher 4

#### IAsymmetricCipher (asymmetric_cipher.hpp)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö —à–∏—Ñ—Ä–æ–≤:
- `encrypt()` - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º
- `decrypt()` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `RSA` - RSA algorithm

### 4. –†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (modes/)

#### IBlockCipherMode (mode.hpp)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤:
- `encrypt() / decrypt()` - –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- `setCipher()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞
- `setPadding()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ö–µ–º—ã –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- `setIV() / getIV()` - —Ä–∞–±–æ—Ç–∞ —Å –≤–µ–∫—Ç–æ—Ä–æ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **ECB** (Electronic Codebook) - –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º, –∫–∞–∂–¥—ã–π –±–ª–æ–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **CBC** (Cipher Block Chaining) - –∫–∞–∂–¥—ã–π –±–ª–æ–∫ XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º
- **PCBC** (Propagating CBC) - –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è CBC —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é
- **CFB** (Cipher Feedback) - –ø–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞
- **OFB** (Output Feedback) - –ø–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞
- **CTR** (Counter) - —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞
- **Random Delta** - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –¥–µ–ª—å—Ç–∞–º–∏

**–ê–¥–∞–ø—Ç–µ—Ä—ã:**
- `StreamCipherMode` - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç `IStreamCipher` –∫ `IBlockCipherMode`
- `AsymmetricCipherMode` - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç `IAsymmetricCipher` –∫ `IBlockCipherMode`

### 5. –°—Ö–µ–º—ã –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è (padding/)

#### IPadding (padding.hpp)
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å—Ö–µ–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è:
- `pad()` - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
- `unpad()` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **PKCS7** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç PKCS#7
- **Zeros** - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª—è–º–∏
- **ANSI X9.23** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç ANSI X9.23
- **ISO 10126** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç ISO 10126

## üîÄ –ê–¥–∞–ø—Ç–µ—Ä—ã

### StreamCipherMode
–ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–≤—ã–µ —à–∏—Ñ—Ä—ã (RC4) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `IBlockCipherMode`:
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RC4 –≤ —Ä–µ–∂–∏–º–∞—Ö CBC, ECB –∏ —Ç.–¥.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### AsymmetricCipherMode
–ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ —à–∏—Ñ—Ä—ã (RSA) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `IBlockCipherMode`:
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RSA –≤ —Ä–µ–∂–∏–º–∞—Ö —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CryptoManager (–æ–¥–∏–Ω —Ä–∞–∑)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –î–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

```cpp
CryptoManager manager;

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
Key key = manager.generateKey("DES");

// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ (—Å–æ–∑–¥–∞–µ—Ç encryptor –≤–Ω—É—Ç—Ä–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç)
std::string plaintext = "Hello, World!";
ByteArray encrypted = manager.encryptString(
    plaintext, "DES", "CBC", "PKCS7", key
);

// –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (—Å–æ–∑–¥–∞–µ—Ç –ù–û–í–´–ô encryptor –≤–Ω—É—Ç—Ä–∏)
std::string decrypted = manager.decryptString(
    encrypted, "DES", "CBC", "PKCS7", key
);
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `encrypt()` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π encryptor. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤!

### –ü—Ä–∏–º–µ—Ä 2: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –î–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

```cpp
CryptoManager manager;
Key key = manager.generateKey("DES");

// –°–æ–∑–¥–∞–µ–º encryptor –û–î–ò–ù –†–ê–ó
auto encryptor = manager.createEncryptor("DES", "CBC", "PKCS7", key);

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –ú–ù–û–ì–û –†–ê–ó (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ!)
ByteArray data1 = utils::stringToBytes("Hello");
ByteArray data2 = utils::stringToBytes("World");
ByteArray data3 = utils::stringToBytes("Test");

ByteArray encrypted1 = encryptor->encrypt(data1);  // –û–¥–∏–Ω encryptor
ByteArray encrypted2 = encryptor->encrypt(data2);  // –¢–æ—Ç –∂–µ encryptor
ByteArray encrypted3 = encryptor->encrypt(data3);  // –¢–æ—Ç –∂–µ encryptor

// –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
ByteArray decrypted1 = encryptor->decrypt(encrypted1);
ByteArray decrypted2 = encryptor->decrypt(encrypted2);
ByteArray decrypted3 = encryptor->decrypt(encrypted3);
```

**‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –û–¥–∏–Ω encryptor –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –±—ã—Å—Ç—Ä–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ!

### –ü—Ä–∏–º–µ—Ä 3: –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IV, —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —à–∏—Ñ—Ä–∞–º–∏

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞

```cpp
#include "crypto/algorithms/des/des.hpp"
#include "crypto/math/random.hpp"

// –°–æ–∑–¥–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º (DES, TripleDES, DEAL, Rijndael, Serpent)
auto des = std::make_shared<DES>();

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –∫–ª—é—á
Key key = math::randomKey(DES_KEY_SIZE);  // –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π –∫–ª—é—á

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–ª—é—á –≤ —à–∏—Ñ—Ä
des->setKey(key);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–ª—é—á–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
if (!des->isValidKey(key)) {
    throw std::runtime_error("Invalid key!");
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç `DES`, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç `IBlockCipher`
- –ö–ª—é—á —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —à–∏—Ñ—Ä
- –®–∏—Ñ—Ä –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è (Padding)

```cpp
#include "crypto/padding/padding.hpp"

// –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ enum
auto padding = IPadding::create(PaddingType::PKCS7);

// –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫—É
auto padding2 = IPadding::create("PKCS7");  // –∏–ª–∏ "ZEROS", "ANSI_X923", "ISO_10126"

// –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã –ø–∞–¥–¥–∏–Ω–≥–æ–≤:
// - PaddingType::PKCS7      ‚Üí PKCS7Padding
// - PaddingType::ZEROS       ‚Üí ZeroPadding
// - PaddingType::ANSI_X923   ‚Üí ANSIX923Padding
// - PaddingType::ISO_10126   ‚Üí ISO10126Padding
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –§–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ `IPadding::create()` —Å–æ–∑–¥–∞–µ—Ç –Ω—É–∂–Ω—ã–π —Ç–∏–ø –ø–∞–¥–¥–∏–Ω–≥–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `std::unique_ptr<IPadding>`
- –ü–∞–¥–¥–∏–Ω–≥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞

#### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```cpp
#include "crypto/modes/mode.hpp"

// –°–æ–∑–¥–∞–µ–º —Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥ IBlockCipherMode::create()
auto cbc = IBlockCipherMode::create(
    CipherMode::CBC,        // –†–µ–∂–∏–º: CBC, ECB, PCBC, CFB, OFB, CTR, RANDOM_DELTA
    des,                    // –ë–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä (std::shared_ptr<IBlockCipher>)
    std::move(padding),     // –ü–∞–¥–¥–∏–Ω–≥ (std::unique_ptr<IPadding>)
    ByteArray()             // IV (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π - —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ `IBlockCipherMode::create()`:**
```cpp
// –í mode_factory.cpp:
switch (mode) {
    case CipherMode::CBC:
        modeObj = std::make_unique<CBCMode>(cipher, std::move(padding));
        break;
    case CipherMode::ECB:
        modeObj = std::make_unique<ECBMode>(cipher, std::move(padding));
        break;
    // ... –∏ —Ç.–¥.
}
```

**–í–∞–∂–Ω–æ:**
- `cipher` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ `std::shared_ptr` (–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–µ–∂–∏–º–∞–º–∏)
- `padding` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ `std::unique_ptr` –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è (move)
- –ï—Å–ª–∏ IV –Ω–µ —É–∫–∞–∑–∞–Ω, —Ä–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π IV

#### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IV (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ —Å IV)

```cpp
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π IV
ByteArray currentIV = cbc->getIV();

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π IV (—Ä–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω blockSize)
ByteArray customIV = math::randomBytes(des->blockSize());  // 8 –±–∞–π—Ç –¥–ª—è DES
cbc->setIV(customIV);

// –ò–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Å–ª—É—á–∞–π–Ω—ã–π IV
cbc->generateRandomIV();
```

**–†–µ–∂–∏–º—ã —Å IV:**
- **CBC, PCBC, CFB, OFB, CTR, Random Delta** - —Ç—Ä–µ–±—É—é—Ç IV
- **ECB** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç IV

#### –®–∞–≥ 5: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```cpp
#include "crypto/core/utils.hpp"

// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
std::string plaintext = "Hello, World!";
ByteArray data = utils::stringToBytes(plaintext);

// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –º–µ—Ç–æ–¥)
ByteArray encrypted = cbc->encrypt(data);

// –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ encrypt():
// 1. IPadding::pad(data, blockSize) ‚Üí –¥–æ–ø–æ–ª–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
// 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
//    - XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º (–∏–ª–∏ IV –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ)
//    - DES::encryptBlock() ‚Üí —à–∏—Ñ—Ä—É–µ—Ç –±–ª–æ–∫
// 3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è CBC:**
```
–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: "Hello, W" (8 –±–∞–π—Ç) + padding
                    ‚Üì
–ë–ª–æ–∫ 1: "Hello, W" (8 –±–∞–π—Ç)
    ‚Üì
XOR —Å IV ‚Üí xored_block
    ‚Üì
DES::encryptBlock(xored_block) ‚Üí cipher_block_1
    ‚Üì
–ë–ª–æ–∫ 2: "orld! + padding" (8 –±–∞–π—Ç)
    ‚Üì
XOR —Å cipher_block_1 ‚Üí xored_block_2
    ‚Üì
DES::encryptBlock(xored_block_2) ‚Üí cipher_block_2
    ‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç: cipher_block_1 + cipher_block_2
```

#### –®–∞–≥ 6: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```cpp
// –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
ByteArray decrypted = cbc->decrypt(encrypted);

// –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ decrypt():
// 1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
//    - DES::decryptBlock() ‚Üí —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –±–ª–æ–∫
//    - XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º (–∏–ª–∏ IV –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ)
// 2. IPadding::unpad() ‚Üí —É–¥–∞–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
// 3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

// –ü—Ä–æ–≤–µ—Ä–∫–∞
std::string result = utils::bytesToString(decrypted);
// result == "Hello, World!"
```

#### –®–∞–≥ 7: –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –ø–∞–¥–¥–∏–Ω–≥–∞)

```cpp
// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –¥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
ByteArray data(16);  // 2 –±–ª–æ–∫–∞ –ø–æ 8 –±–∞–π—Ç
// ... –∑–∞–ø–æ–ª–Ω—è–µ–º data ...

// –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –º–µ—Ç–æ–¥ (–±–µ–∑ –ø–∞–¥–¥–∏–Ω–≥–∞)
ByteArray encrypted(16);
cbc->encrypt(data.data(), encrypted.data(), 16);  // data, output, length

// –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
ByteArray decrypted(16);
cbc->decrypt(encrypted.data(), decrypted.data(), 16);
```

#### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –ø—É—Ç–∏:

```cpp
#include "crypto/algorithms/des/des.hpp"
#include "crypto/modes/mode.hpp"
#include "crypto/padding/padding.hpp"
#include "crypto/core/utils.hpp"
#include "crypto/math/random.hpp"

// 1. –°–æ–∑–¥–∞–Ω–∏–µ —à–∏—Ñ—Ä–∞
auto des = std::make_shared<DES>();
Key key = math::randomKey(DES_KEY_SIZE);
des->setKey(key);

// 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–¥–¥–∏–Ω–≥–∞
auto padding = IPadding::create(PaddingType::PKCS7);

// 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞
auto cbc = IBlockCipherMode::create(
    CipherMode::CBC,
    des,
    std::move(padding)
);

// 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IV (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ByteArray customIV = math::randomBytes(8);
cbc->setIV(customIV);

// 5. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
std::string plaintext = "Hello, World!";
ByteArray data = utils::stringToBytes(plaintext);
ByteArray encrypted = cbc->encrypt(data);

// 6. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
ByteArray decrypted = cbc->decrypt(encrypted);
std::string result = utils::bytesToString(decrypted);
```

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å CryptoManager:

| –î–µ–π—Å—Ç–≤–∏–µ | CryptoManager | –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø—É—Ç—å |
|----------|---------------|---------------------|
| –°–æ–∑–¥–∞–Ω–∏–µ —à–∏—Ñ—Ä–∞ | `createCipher()` –≤–Ω—É—Ç—Ä–∏ | `std::make_shared<DES>()` |
| –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–¥–¥–∏–Ω–≥–∞ | `parsePadding()` + `IPadding::create()` | `IPadding::create()` –Ω–∞–ø—Ä—è–º—É—é |
| –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ | `IBlockCipherMode::create()` –≤–Ω—É—Ç—Ä–∏ | `IBlockCipherMode::create()` –Ω–∞–ø—Ä—è–º—É—é |
| –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫ | `parseMode("CBC")` | –ò—Å–ø–æ–ª—å–∑—É–µ–º `CipherMode::CBC` –Ω–∞–ø—Ä—è–º—É—é |
| –ö–æ–Ω—Ç—Ä–æ–ª—å IV | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å |
| –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –ù–µ—Ç (—Å–æ–∑–¥–∞–µ—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑) | –î–∞ (–æ–¥–∏–Ω encryptor) |

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –ø—É—Ç–∏:

1. **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ IV** - –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IV
2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ encryptor'–∞** - –æ–¥–∏–Ω encryptor –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
3. **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º** - –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å —à–∏—Ñ—Ä, –ø–∞–¥–¥–∏–Ω–≥, —Ä–µ–∂–∏–º
4. **–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã** - `encrypt(data, output, length)` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
5. **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–µ—Ç–µ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞–∫ —É–≥–æ–¥–Ω–æ

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø—É—Ç—å:

- ‚úÖ –ù—É–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å IV
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å —Å—ã—Ä—ã–º–∏ –±–∞–π—Ç–∞–º–∏ –±–µ–∑ –ø–∞–¥–¥–∏–Ω–≥–∞
- ‚úÖ –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —à–∏—Ñ—Ä–∞–º–∏/—Ä–µ–∂–∏–º–∞–º–∏
- ‚úÖ –û—Ç–ª–∞–¥–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | –ö–æ–Ω—Ç—Ä–æ–ª—å |
|--------|-------------------|---------------|----------|
| `CryptoManager::encrypt()` | –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | ‚≠ê‚≠ê (—Å–æ–∑–¥–∞–µ—Ç encryptor –∫–∞–∂–¥—ã–π —Ä–∞–∑) | ‚≠ê‚≠ê (–º–∞–ª–æ –∫–æ–Ω—Ç—Ä–æ–ª—è) |
| `createEncryptor() + encrypt()` | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–æ–¥–∏–Ω encryptor) | ‚≠ê‚≠ê‚≠ê‚≠ê (—Ö–æ—Ä–æ—à–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å) |
| –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å) |

### –ü—Ä–∏–º–µ—Ä 3: –§–∞–π–ª–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```cpp
auto des = std::make_shared<DES>();
des->setKey(key);
auto padding = IPadding::create(PaddingType::PKCS7);
auto cbc = IBlockCipherMode::create(CipherMode::CBC, des, std::move(padding));

AsyncFileEncryptor encryptor(cbc, 4); // 4 –ø–æ—Ç–æ–∫–∞

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
auto future = encryptor.encryptFileAsync("input.txt", "output.enc");
bool success = future.get();
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π**
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ `ciphers/`
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `algorithms/`

2. **–ü–∞—Ç—Ç–µ—Ä–Ω Strategy**
   - –†–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç –æ–¥–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º

3. **–ü–∞—Ç—Ç–µ—Ä–Ω Factory**
   - `CryptoManager` –∏ `ModeFactory` —Å–æ–∑–¥–∞—é—Ç –æ–±—ä–µ–∫—Ç—ã
   - –°–∫—Ä—ã–≤–∞—é—Ç –¥–µ—Ç–∞–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è

4. **–ü–∞—Ç—Ç–µ—Ä–Ω Adapter**
   - `StreamCipherMode` –∏ `AsymmetricCipherMode` –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —à–∏—Ñ—Ä–æ–≤

5. **–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
   - –í—Å–µ —Ä–µ–∂–∏–º—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç `IBlockCipherMode`
   - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

## üîç –ì–¥–µ —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|-----------|-----------|------------|
| –ë–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã | `ciphers/block_cipher.hpp` | `algorithms/*/` |
| –ü–æ—Ç–æ–∫–æ–≤—ã–µ —à–∏—Ñ—Ä—ã | `ciphers/stream_cipher.hpp` | `algorithms/rc4/` |
| –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ | `ciphers/asymmetric_cipher.hpp` | `algorithms/rsa/` |
| –†–µ–∂–∏–º—ã | `modes/mode.hpp` | `modes/*.cpp` |
| –ü–∞–¥–¥–∏–Ω–≥–∏ | `padding/padding.hpp` | `padding/*.cpp` |
| –ú–µ–Ω–µ–¥–∂–µ—Ä | `crypto_manager.hpp` | `crypto_manager.cpp` |
| –§–∞–±—Ä–∏–∫–∞ —Ä–µ–∂–∏–º–æ–≤ | `modes/mode.hpp` | `modes/mode_factory.cpp` |

## üöÄ –ü–æ—Ç–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è encryptor

```
1. CryptoManager::createEncryptor("DES", "CBC", "PKCS7", key)
   ‚îÇ
2. parseMode("CBC") ‚Üí CipherMode::CBC
   ‚îÇ
3. parsePadding("PKCS7") ‚Üí PaddingType::PKCS7
   ‚îÇ
4. createCipher("DES", key) ‚Üí std::shared_ptr<DES>
   ‚îÇ
5. IPadding::create(PaddingType::PKCS7) ‚Üí std::unique_ptr<PKCS7Padding>
   ‚îÇ
6. IBlockCipherMode::create(CBC, des, padding) ‚Üí std::unique_ptr<CBCMode>
   ‚îÇ
7. –í–æ–∑–≤—Ä–∞—Ç –≥–æ—Ç–æ–≤–æ–≥–æ encryptor'–∞
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Core (core/)
- `types.hpp` - –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã (Byte, ByteArray, Key, Block)
- `utils.hpp` - —É—Ç–∏–ª–∏—Ç—ã (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è, XOR, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π)
- `exceptions.hpp` - –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `endianness.hpp` - —Ä–∞–±–æ—Ç–∞ —Å –ø–æ—Ä—è–¥–∫–æ–º –±–∞–π—Ç–æ–≤

### Math (math/)
- `random.hpp` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
- `big_integer.hpp` - –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞ –¥–ª—è RSA/DH
- `galois_field.hpp` - –ø–æ–ª–µ –ì–∞–ª—É–∞ –¥–ª—è Rijndael

### IO (io/)
- `file_encryptor.hpp` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ñ–∞–π–ª–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- `async_file_encryptor.hpp` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ñ–∞–π–ª–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ IBlockCipher –≤ block_cipher.hpp

